var path = require('path');
var exec = require('child_process').exec;

function execute(args, callback) {
  var command = 'pdftk ' + args.join(' ');
  exec(command, {encoding: 'binary', maxBuffer: 10485760}, function(err, stdout, stderr) {
    if(err) return callback(new Error(err));
    callback(null, new Buffer(stdout, 'binary'));
  });
}

exports.pages = function(pdf, start, end, fileName, callback) {
  var range = (start || 1) + '-' + (end || 'end');
  execute([pdf, 'cat', range, 'output ' + fileName + '.pdf'], callback);
};


exports.merge = function(pdf, xfdf, callback) {
  execute([pdf, 'fill_form ', xfdf, 'output - flatten'], callback);
};
